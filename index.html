<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
        // console.log(window.geemails.length);
    var test = document.getElementsByClassName("mainBlock");
    

    var sideWindow = document.createElement("div");
        sideWindow.id = "side";
        theBody.appendChild(sideWindow);

    var emailCount = document.createElement("div");
    	emailCount.id = "theCount";
    	var counter = window.geemails.length;
    	emailCount.innerHTML = "Messages: " + counter;
    	sideWindow.appendChild(emailCount);

    var inbox = document.createElement("div");
    theBody.appendChild(inbox);
    
    // setInterval(addEmail, 5000);

    function addEmail(){
    	var myVar = window.getNewMessage();

    	var newDivBlock = document.createElement("div");
    	newDivBlock.className = "mainBlock";
    	inbox.appendChild(newDivBlock);

    	var newBreak = document.createElement("br");
    	inbox.appendChild(newBreak);

    	var newDateDive = document.createElement("div");
    	newDateDive.className = "theDate";
    	newDateDive.innerHTML = myVar.date;
    	newDivBlock.appendChild(newDateDive);

    	var newSenderDiv = document.createElement("div");
    	newSenderDiv.className = "theSender";
    	newSenderDiv.innerHTML = myVar.sender;
    	newDivBlock.appendChild(newSenderDiv);

    	var newSubjectDiv = document.createElement("div");
    	newSubjectDiv.className = "theSubject";
    	newSubjectDiv.innerHTML = myVar.subject;
    	newDivBlock.appendChild(newSubjectDiv);

    	var newMessDiv = document.createElement("div");
    	newMessDiv.className = "theMessage";
    	newMessDiv.innerHTML = myVar.body;
    	newDivBlock.appendChild(newMessDiv);

    	var newerBreak = document.createElement("br");
    	// inbox.appendChild(newerBreak);

    	for(var j = 0; j < test.length; j++){
  		document.getElementsByClassName("mainBlock")[j].addEventListener("click", showEmail);
		}

		inbox.insertBefore(newDivBlock, inbox.childNodes[0]);
		inbox.insertBefore(newerBreak, inbox.childNodes[0]);

  		counter = counter + 1;
    	emailCount.innerHTML = "Messages: " + counter;

	}
	
	



    for(var i = 0; i<window.geemails.length; i++){

    	var divBlock = document.createElement("div");
    	divBlock.className = "mainBlock";
    	inbox.appendChild(divBlock);
    	// document.getElementsByClassName("mainBlock")[i].addEventListener("click", showEmail);

    	var br = document.createElement("br");
    	inbox.appendChild(br);

    	var dateDiv = document.createElement("div");
    	dateDiv.className = "theDate";
    	dateDiv.innerHTML = window.geemails[i].date;
    	divBlock.appendChild(dateDiv);

  		var senderDiv = document.createElement("div");
  		senderDiv.className = "theSender";
  		senderDiv.innerHTML = window.geemails[i].sender;
  		divBlock.appendChild(senderDiv);
  		

  		var subjectDiv = document.createElement("div");
  		subjectDiv.className = "theSubject";
  		subjectDiv.innerHTML = window.geemails[i].subject;
  		divBlock.appendChild(subjectDiv);
  		

  		var messDiv = document.createElement("div");
  		messDiv.className = "theMessage";
  		messDiv.innerHTML = window.geemails[i].body;
  		divBlock.appendChild(messDiv);
  	}
  	

  	for(var j = 0; j < test.length; j++){
  		document.getElementsByClassName("mainBlock")[j].addEventListener("click", showEmail);
  	}

	console.log(document.getElementsByClassName("mainBlock").length);

	function showEmail(){
      	var theEmail = this.querySelectorAll(".theMessage")[0];
      	if(theEmail.style.display === "none"){
      		theEmail.style.display = "block";
      	}else{
      		theEmail.style.display = "none";
      	}
     }

     


     };
      
     




    </script>
	</head>
	<body id="theBody">
		<div class="container" id="main">
			Build Me!
		</div>
	</body>
</html>